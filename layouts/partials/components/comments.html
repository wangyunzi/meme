{{ if and (.Params.comments | default .Site.Params.enableComments) (eq hugo.Environment "production") }}
    {{- if or (in .Site.Params.mainSections .Section) .Params.comments }}
    
    {{ if not .Site.Params.autoLoadComments }}
    <div class="load-comments">
    <div id="load-comments">{{ i18n "loadComments" }}</div>
    </div>
    {{  end }}

    <section class="comments">
      <div class="tabs">
        <input name="tabs" type="radio" id="tab-1" checked class="input" />
        <label for="tab-1" class="label">Twikoo</label>
        <div class="panel">
          <div id="tcomment"></div>
          <script src="https://cdn.staticfile.org/twikoo/1.6.7/twikoo.all.min.js"></script>
          <!-- lightGallery -->
          <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@2.1.8/css/lightgallery.css">
          <script src="https://cdn.jsdelivr.net/npm/lightgallery@2.1.8/lightgallery.min.js"></script>
          <script>
          twikoo.init({
          envId: 'https://twikoo.wangyunzi.com/', // è…¾è®¯äº‘ç¯å¢ƒå¡« envIdï¼›Vercel ç¯å¢ƒå¡«åœ°å€ï¼ˆhttps://xxx.vercel.appï¼‰
          el: '#tcomment', // å®¹å™¨å…ƒç´ 
          // region: 'ap-guangzhou', // ç¯å¢ƒåœ°åŸŸï¼Œé»˜è®¤ä¸º ap-shanghaiï¼Œè…¾è®¯äº‘ç¯å¢ƒå¡« ap-shanghai æˆ– ap-guangzhouï¼›Vercel ç¯å¢ƒä¸å¡«
          // path: location.pathname, // ç”¨äºåŒºåˆ†ä¸åŒæ–‡ç« çš„è‡ªå®šä¹‰ js è·¯å¾„ï¼Œå¦‚æœæ‚¨çš„æ–‡ç« è·¯å¾„ä¸æ˜¯ location.pathnameï¼Œéœ€ä¼ æ­¤å‚æ•°
          // lang: 'zh-CN', // ç”¨äºæ‰‹åŠ¨è®¾å®šè¯„è®ºåŒºè¯­è¨€ï¼Œæ”¯æŒçš„è¯­è¨€åˆ—è¡¨ https://github.com/imaegoo/twikoo/blob/main/src/client/utils/i18n/index.js
        
          onCommentLoaded: function () {
               // å¦‚æœå½“å‰é¡µæœ‰è¯„è®ºå°±æ‰§è¡Œå‡½æ•°
if (document.getElementById('post-comment')) owoBig();
// è¡¨æƒ…æ”¾å¤§
function owoBig() {
    let flag = 1, // è®¾ç½®èŠ‚æµé˜€
        owo_time = '', // è®¾ç½®è®¡æ—¶å™¨
        m = 3; // è®¾ç½®æ”¾å¤§å€æ•°
    // åˆ›å»ºç›’å­
    let div = document.createElement('div'),
        body = document.querySelector('body');
    // è®¾ç½®ID
    div.id = 'owo-big';
    // æ’å…¥ç›’å­
    body.appendChild(div)

    // æ„é€ observer
    let observer = new MutationObserver(mutations => {

        for (let i = 0; i < mutations.length; i++) {
            let dom = mutations[i].addedNodes,
                owo_body = '';
            if (dom.length == 2 && dom[1].className == 'OwO-body') owo_body = dom[1];
            // å¦‚æœéœ€è¦åœ¨è¯„è®ºå†…å®¹ä¸­å¯ç”¨æ­¤åŠŸèƒ½è¯·è§£é™¤ä¸‹é¢çš„æ³¨é‡Š
            // else if (dom.length == 1 && dom[0].className == 'tk-comment') owo_body = dom[0];
            else continue;
            
            // ç¦ç”¨å³é”®ï¼ˆæ‰‹æœºç«¯é•¿æŒ‰ä¼šå‡ºç°å³é”®èœå•ï¼Œä¸ºäº†ä½“éªŒç»™ç¦ç”¨æ‰ï¼‰
            if (document.body.clientWidth <= 768) owo_body.addEventListener('contextmenu', e => e.preventDefault());
            // é¼ æ ‡ç§»å…¥
            owo_body.onmouseover = (e) => {
                    if (flag && e.target.tagName == 'IMG') {
                        flag = 0;
                        // ç§»å…¥300æ¯«ç§’åæ˜¾ç¤ºç›’å­
                        owo_time = setTimeout(() => {
                            let height = e.path[0].clientHeight * m, // ç›’å­é«˜
                                width = e.path[0].clientWidth * m, // ç›’å­å®½
                                left = (e.x - e.offsetX) - (width - e.path[0].clientWidth) / 2, // ç›’å­ä¸å±å¹•å·¦è¾¹è·ç¦»
                                top = e.y - e.offsetY; // ç›’å­ä¸å±å¹•é¡¶éƒ¨è·ç¦»

                            if ((left + width) > body.clientWidth) left -= ((left + width) - body.clientWidth + 10); // å³è¾¹ç¼˜æ£€æµ‹ï¼Œé˜²æ­¢è¶…å‡ºå±å¹•
                            if (left < 0) left = 10; // å·¦è¾¹ç¼˜æ£€æµ‹ï¼Œé˜²æ­¢è¶…å‡ºå±å¹•
                            // è®¾ç½®ç›’å­æ ·å¼
                            div.style.cssText = `display:flex; height:${height}px; width:${width}px; left:${left}px; top:${top}px;`;
                            // åœ¨ç›’å­ä¸­æ’å…¥å›¾ç‰‡
                            div.innerHTML = `<img src="${e.target.src}">`
                        }, 300);
                    }
                };
            // é¼ æ ‡ç§»å‡ºéšè—ç›’å­
            owo_body.onmouseout = () => { div.style.display = 'none', flag = 1, clearTimeout(owo_time); }
        }

    })
    observer.observe(document.getElementById('post-comment'), { subtree: true, childList: true }) // ç›‘å¬çš„ å…ƒç´  å’Œ é…ç½®é¡¹
}
            var commentContents = document.getElementsByClassName('tk-content');
            for (var i = 0; i < commentContents.length; i++) {
              var commentItem = commentContents[i];
              var imgEls = commentItem.getElementsByTagName('img');
              if (imgEls.length > 0) {
                for (var j = 0; j < imgEls.length; j++) {
                  var imgEl = imgEls[j];
                  var aEl = document.createElement('a');
                  aEl.setAttribute('class', 'tk-lg-link');
                  aEl.setAttribute('href', imgEl.getAttribute('src'));
                  aEl.setAttribute('data-src', imgEl.getAttribute('src'));
                  aEl.appendChild(imgEl.cloneNode(false));
                  imgEl.parentNode.insertBefore(aEl, imgEl.nextSibling);
                  imgEl.remove();
                }
                // lightGallery(commentItem, {
                //   selector: '.tk-lg-link',
                //   share: true
                // });
              }
            }
          }
        })
        </script>
        </div>
        <input name="tabs" type="radio" id="tab-2" class="input" />
        <label for="tab-2" class="label">Disqus</label>
        <div class="panel">
          <div id="disqus_thread"></div>
          <script>
              /**
              *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
              *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */
              /*
              var disqus_config = function () {
              this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
              this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
              };
              */
              (function() { // DON'T EDIT BELOW THIS LINE
              var d = document, s = d.createElement('script');
              s.src = 'https://wangyunzi-meme.disqus.com/embed.js';
              s.setAttribute('data-timestamp', +new Date());
              (d.head || d.body).appendChild(s);
              })();
          </script>
          <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        </div>
    </section>
    
    {{ if .Site.Params.enableDisqus }}
    <div id="disqus_thread"></div>
    {{ end }}
    
    {{ if .Site.Params.enableValine }}
    <div id="vcomments"></div>
    {{ end }}
    
    {{ if .Site.Params.enableWaline }}
    <div id="waline"></div>
    {{ end }}
    
    {{ if .Site.Params.enableUtterances }}
    <div id="utterances"></div>
    {{ end }}
    
    {{ if .Site.Params.enableGitalk }}
    <div id="gitalk-container"></div>
    {{ end }}
    
    {{ end }}
{{ end }}


{{- if .Site.Params.enableTwikoo -}}
<div class="pagination__title">
  <span class="pagination__title-h">ğŸ’¬æ¬¢è¿è¯„è®º</span>
  <hr />
</div>
  <div id="tcomment"></div>
        <script src="https://cdn.staticfile.org/twikoo/1.6.7/twikoo.all.min.js"></script>
        <!-- lightGallery -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@2.1.8/css/lightgallery.css">
        <script src="https://cdn.jsdelivr.net/npm/lightgallery@2.1.8/lightgallery.min.js"></script>
        <script>
        twikoo.init({
        envId: 'https://twikoo.wangyunzi.com/', // è…¾è®¯äº‘ç¯å¢ƒå¡« envIdï¼›Vercel ç¯å¢ƒå¡«åœ°å€ï¼ˆhttps://xxx.vercel.appï¼‰
        el: '#tcomment', // å®¹å™¨å…ƒç´ 
        // region: 'ap-guangzhou', // ç¯å¢ƒåœ°åŸŸï¼Œé»˜è®¤ä¸º ap-shanghaiï¼Œè…¾è®¯äº‘ç¯å¢ƒå¡« ap-shanghai æˆ– ap-guangzhouï¼›Vercel ç¯å¢ƒä¸å¡«
        // path: location.pathname, // ç”¨äºåŒºåˆ†ä¸åŒæ–‡ç« çš„è‡ªå®šä¹‰ js è·¯å¾„ï¼Œå¦‚æœæ‚¨çš„æ–‡ç« è·¯å¾„ä¸æ˜¯ location.pathnameï¼Œéœ€ä¼ æ­¤å‚æ•°
        // lang: 'zh-CN', // ç”¨äºæ‰‹åŠ¨è®¾å®šè¯„è®ºåŒºè¯­è¨€ï¼Œæ”¯æŒçš„è¯­è¨€åˆ—è¡¨ https://github.com/imaegoo/twikoo/blob/main/src/client/utils/i18n/index.js
      
        onCommentLoaded: function () {
          var commentContents = document.getElementsByClassName('tk-content');
          for (var i = 0; i < commentContents.length; i++) {
            var commentItem = commentContents[i];
            var imgEls = commentItem.getElementsByTagName('img');
            if (imgEls.length > 0) {
              for (var j = 0; j < imgEls.length; j++) {
                var imgEl = imgEls[j];
                var aEl = document.createElement('a');
                aEl.setAttribute('class', 'tk-lg-link');
                aEl.setAttribute('href', imgEl.getAttribute('src'));
                aEl.setAttribute('data-src', imgEl.getAttribute('src'));
                aEl.appendChild(imgEl.cloneNode(false));
                imgEl.parentNode.insertBefore(aEl, imgEl.nextSibling);
                imgEl.remove();
              }
              lightGallery(commentItem, {
                selector: '.tk-lg-link',
                share: true
              });
            }
          }
        }
      })
      </script>

{{- end }}






